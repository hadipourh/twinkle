#include <stdio.h>
#include<stdlib.h>
#include<stdint.h>

/* /1* for 64 bit version *1/ */
/* #define ROUNDS 5 */

/* for 128 bit version */
// #define ROUNDS 9.5

/* /1* for 256 bit version *1/ */
/* #define ROUNDS 18.5 */

#include "my_lib.h"
#include "rc.h"
#include "oracle.h"

int main(){
    uint64_t *state = mem_alloc(16*128);
    uint64_t *key = mem_alloc(16*128);

    // state[5]=0x1000000000;



    /* ---------------------------------------------------------------------------------- */
    /* 1st test vector */
    /* ---------------------------------------------------------------------------------- */
    uint16_t key_1d[80] = {
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
        0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}; 


    /* storing key lane wise from 1d array of key */
    _1d_to_lane_wise(key, key_1d);
    float ROUNDS=1.5;

    print_lane("output: ", state);
    oracle( state, key,ROUNDS);

    /* printing */ 
    print_lane("output: ", state);
    printf("\n");
}
